===== 开始PyCaret AutoML流程 =====
初始化完成，将使用PyCaret库进行AutoML建模
数据文件路径: D:\Workspace\FI-CAD-Predictor\data/cleaned/basic_cleaned_data.csv
PyCaret模型保存目录: D:\Workspace\FI-CAD-Predictor\output/models/pycaret/
PyCaret图表保存目录: D:\Workspace\FI-CAD-Predictor\output/figures/pycaret
结果输出目录: D:\Workspace\FI-CAD-Predictor\output/results/
PyCaret配置: {'setup': {'target': 'CVD', 'session_id': 42, 'train_size': 0.8, 'data_split_shuffle': True, 'data_split_stratify': True, 'normalize': True, 'transformation': True, 'low_variance_threshold': 0.01, 'remove_multicollinearity': True, 'multicollinearity_threshold': 0.9, 'feature_selection': True, 'n_features_to_select': 0.8, 'fix_imbalance': False, 'experiment_name': 'pycaret_automl', 'verbose': False}, 'compare': {'n_select': 5, 'fold': 3, 'round': 4, 'sort': 'AUC', 'turbo': True}, 'tune': {'n_iter': 10, 'optimize': 'AUC', 'fold': 3, 'round': 4}, 'models': None}
已读取清洗后数据，形状: (13153, 31)
数据所有列: ['Age', 'Gender', 'Marital', 'EducationLevel', 'chestPainWhenClimbingOrWalkingQuickly', 'sleepWasRestless', 'feelAnyBodyPain', 'weightChange', 'feelDepressed', 'selfCommentOfHealth', 'Smoke', 'DrinkAlcohol', 'pulse', 'whiteBloodCell_inThousands', 'meanCorpuscularVolume', 'platelets_10e9perL', 'bloodUreaNitrogen_mgperdl', 'glucose_mgperdl', 'creatinine_mgperdl', 'totalCholesterol_mgperdl', 'triglycerides_mgperdl', 'hdlCholesterol_mgperdl', 'ldlCholesterol_mgperdl', 'cReactiveProtein_mgperdl', 'glycatedHemoglobin', 'uricAcid_mgperdl', 'hematocrit', 'hemoglobin_gperdl', 'cystatinC_mgperl', 'FI', 'CVD']
FI 列存在，描述统计如下：
count    13153.000000
mean         0.156338
std          0.134205
min          0.000000
25%          0.045455
50%          0.136364
75%          0.272727
max          0.727273
Name: FI, dtype: float64

===== 开始PyCaret AutoML建模 =====
建模前数据所有列: ['Age', 'Gender', 'Marital', 'EducationLevel', 'chestPainWhenClimbingOrWalkingQuickly', 'sleepWasRestless', 'feelAnyBodyPain', 'weightChange', 'feelDepressed', 'selfCommentOfHealth', 'Smoke', 'DrinkAlcohol', 'pulse', 'whiteBloodCell_inThousands', 'meanCorpuscularVolume', 'platelets_10e9perL', 'bloodUreaNitrogen_mgperdl', 'glucose_mgperdl', 'creatinine_mgperdl', 'totalCholesterol_mgperdl', 'triglycerides_mgperdl', 'hdlCholesterol_mgperdl', 'ldlCholesterol_mgperdl', 'cReactiveProtein_mgperdl', 'glycatedHemoglobin', 'uricAcid_mgperdl', 'hematocrit', 'hemoglobin_gperdl', 'cystatinC_mgperl', 'FI', 'CVD']
建模前 FI 列描述统计：
count    13153.000000
mean         0.156338
std          0.134205
min          0.000000
25%          0.045455
50%          0.136364
75%          0.272727
max          0.727273
Name: FI, dtype: float64
初始化PyCaret实验...
PyCaret实验初始化完成
PyCaret setup 后特征列: ['Age', 'Gender', 'Marital', 'EducationLevel', 'chestPainWhenClimbingOrWalkingQuickly', 'sleepWasRestless', 'feelAnyBodyPain', 'weightChange', 'feelDepressed', 'selfCommentOfHealth', 'Smoke', 'DrinkAlcohol', 'pulse', 'whiteBloodCell_inThousands', 'meanCorpuscularVolume', 'platelets_10e9perL', 'bloodUreaNitrogen_mgperdl', 'glucose_mgperdl', 'creatinine_mgperdl', 'totalCholesterol_mgperdl', 'triglycerides_mgperdl', 'hdlCholesterol_mgperdl', 'ldlCholesterol_mgperdl', 'cReactiveProtein_mgperdl', 'glycatedHemoglobin', 'uricAcid_mgperdl', 'hematocrit', 'hemoglobin_gperdl', 'cystatinC_mgperl', 'FI']
PyCaret setup 后，FI 作为特征被保留！

比较所有模型...
Processing:   0%|          | 0/73 [00:00<?, ?it/s]Processing:   7%|▋         | 5/73 [00:13<03:03,  2.70s/it]Processing:   8%|▊         | 6/73 [00:17<03:17,  2.94s/it]Processing:  10%|▉         | 7/73 [00:17<02:29,  2.26s/it]Processing:  12%|█▏        | 9/73 [00:31<04:31,  4.24s/it]Processing:  14%|█▎        | 10/73 [00:37<04:48,  4.57s/it]Processing:  15%|█▌        | 11/73 [00:37<03:37,  3.50s/it]Processing:  18%|█▊        | 13/73 [00:51<04:55,  4.93s/it]Processing:  19%|█▉        | 14/73 [00:56<04:46,  4.85s/it]Processing:  21%|██        | 15/73 [00:56<03:37,  3.74s/it]Processing:  23%|██▎       | 17/73 [01:25<07:44,  8.29s/it]Processing:  25%|██▍       | 18/73 [01:33<07:29,  8.17s/it]Processing:  26%|██▌       | 19/73 [01:34<05:38,  6.27s/it]Processing:  29%|██▉       | 21/73 [01:56<07:15,  8.38s/it]Processing:  30%|███       | 22/73 [02:01<06:24,  7.54s/it]Processing:  32%|███▏      | 23/73 [02:01<04:46,  5.73s/it]Processing:  34%|███▍      | 25/73 [02:13<04:39,  5.83s/it]Processing:  36%|███▌      | 26/73 [02:17<04:12,  5.37s/it]Processing:  37%|███▋      | 27/73 [02:17<03:08,  4.09s/it]Processing:  40%|███▉      | 29/73 [02:29<03:33,  4.85s/it]Processing:  41%|████      | 30/73 [02:33<03:18,  4.62s/it]Processing:  42%|████▏     | 31/73 [02:33<02:28,  3.53s/it]Processing:  45%|████▌     | 33/73 [02:43<02:43,  4.09s/it]Processing:  47%|████▋     | 34/73 [02:47<02:36,  4.01s/it]Processing:  48%|████▊     | 35/73 [02:47<01:56,  3.06s/it]Processing:  51%|█████     | 37/73 [02:57<02:19,  3.86s/it]Processing:  52%|█████▏    | 38/73 [03:00<02:13,  3.81s/it]Processing:  53%|█████▎    | 39/73 [03:00<01:38,  2.91s/it]Processing:  56%|█████▌    | 41/73 [03:13<02:14,  4.20s/it]Processing:  58%|█████▊    | 42/73 [03:16<02:07,  4.12s/it]Processing:  59%|█████▉    | 43/73 [03:17<01:34,  3.14s/it]Processing:  62%|██████▏   | 45/73 [03:26<01:46,  3.79s/it]Processing:  63%|██████▎   | 46/73 [03:30<01:43,  3.83s/it]Processing:  64%|██████▍   | 47/73 [03:30<01:16,  2.93s/it]Processing:  67%|██████▋   | 49/73 [03:40<01:30,  3.77s/it]Processing:  68%|██████▊   | 50/73 [03:44<01:26,  3.76s/it]Processing:  70%|██████▉   | 51/73 [03:44<01:03,  2.87s/it]Processing:  73%|███████▎  | 53/73 [03:55<01:17,  3.88s/it]Processing:  74%|███████▍  | 54/73 [03:58<01:12,  3.84s/it]Processing:  75%|███████▌  | 55/73 [03:58<00:52,  2.93s/it]Processing:  78%|███████▊  | 57/73 [04:13<01:16,  4.80s/it]Processing:  79%|███████▉  | 58/73 [04:17<01:08,  4.56s/it]Processing:  81%|████████  | 59/73 [04:17<00:48,  3.48s/it]Processing:  84%|████████▎ | 61/73 [04:39<01:18,  6.52s/it]Processing:  85%|████████▍ | 62/73 [04:42<01:02,  5.70s/it]Processing:  86%|████████▋ | 63/73 [04:42<00:43,  4.34s/it]Processing:  89%|████████▉ | 65/73 [04:50<00:33,  4.16s/it]Processing:  90%|█████████ | 66/73 [04:53<00:27,  3.93s/it]Processing:  92%|█████████▏| 67/73 [04:53<00:17,  3.00s/it]Processing:  95%|█████████▍| 69/73 [04:56<00:09,  2.44s/it]Processing:  96%|█████████▌| 70/73 [05:00<00:07,  2.61s/it]Processing:  97%|█████████▋| 71/73 [05:02<00:05,  2.52s/it]Processing:  99%|█████████▊| 72/73 [05:04<00:02,  2.42s/it]Processing: 100%|██████████| 73/73 [05:06<00:00,  2.36s/it]                                                                                               Model  Accuracy     AUC  Recall   Prec.  \
lr                    Logistic Regression    0.8706  0.7547  0.0756  0.5318   
lda          Linear Discriminant Analysis    0.8673  0.7539  0.1229  0.4730   
gbc          Gradient Boosting Classifier    0.8697  0.7501  0.0713  0.5074   
catboost              CatBoost Classifier    0.0000  0.7496  0.0000  0.0000   
lightgbm  Light Gradient Boosting Machine    0.8672  0.7386  0.0764  0.4586   
ada                  Ada Boost Classifier    0.8664  0.7358  0.1055  0.4547   
nb                            Naive Bayes    0.8189  0.7303  0.3236  0.3131   
rf               Random Forest Classifier    0.8671  0.7200  0.0385  0.4096   
et                 Extra Trees Classifier    0.8649  0.7169  0.0574  0.3806   
qda       Quadratic Discriminant Analysis    0.8270  0.7141  0.2691  0.3118   
xgboost         Extreme Gradient Boosting    0.8624  0.6985  0.0960  0.3935   
knn                K Neighbors Classifier    0.8584  0.6139  0.0873  0.3387   
dt               Decision Tree Classifier    0.7816  0.5556  0.2502  0.2137   
dummy                    Dummy Classifier    0.8693  0.5000  0.0000  0.0000   
svm                   SVM - Linear Kernel    0.8699  0.0000  0.0291  0.3736   
ridge                    Ridge Classifier    0.8695  0.0000  0.0051  0.3905   

              F1   Kappa     MCC  TT (Sec)  
lr        0.1324  0.1033  0.1638    4.4867  
lda       0.1950  0.1490  0.1902    3.1400  
gbc       0.1247  0.0959  0.1526    4.0200  
catboost  0.0000  0.0000  0.0000    7.2333  
lightgbm  0.1308  0.0967  0.1446    4.9800  
ada       0.1709  0.1279  0.1695    3.3367  
nb        0.3181  0.2137  0.2139    4.6467  
rf        0.0704  0.0491  0.0922    3.9633  
et        0.0995  0.0681  0.1052    3.3033  
qda       0.2887  0.1909  0.1917    3.2533  
xgboost   0.1542  0.1083  0.1412    3.5533  
knn       0.1387  0.0900  0.1151    4.7300  
dt        0.2304  0.1041  0.1046    9.8500  
dummy     0.0000  0.0000  0.0000    2.6033  
svm       0.0536  0.0415  0.0826    7.5800  
ridge     0.0100  0.0078  0.0370    3.9833  
模型比较完成，已选出前5个模型

对选定的模型进行调优和保存...

===== 开始调优模型: LogisticRegression =====
Processing:   0%|          | 0/7 [00:00<?, ?it/s]Fitting 3 folds for each of 10 candidates, totalling 30 fits
Processing:  43%|████▎     | 3/7 [01:24<01:52, 28.08s/it]Processing:  86%|████████▌ | 6/7 [01:29<00:12, 12.63s/it]Processing: 100%|██████████| 7/7 [01:32<00:00, 10.42s/it]                                                               Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Fold                                                          
0       0.7035  0.7685  0.7015  0.2629  0.3824  0.2372  0.2868
1       0.6958  0.7355  0.6397  0.2452  0.3545  0.2043  0.2445
2       0.6920  0.7628  0.6965  0.2532  0.3714  0.2224  0.2724
Mean    0.6971  0.7556  0.6793  0.2537  0.3694  0.2213  0.2679
Std     0.0048  0.0144  0.0280  0.0072  0.0115  0.0135  0.0175
调优完成: LogisticRegression
Transformation Pipeline and Model Successfully Saved
模型已保存到: D:\Workspace\FI-CAD-Predictor\output/models/pycaret/pycaret_logisticregression_model
所有模型超参数已集中保存到 pycaret_model_config.yaml
LogisticRegression预测结果已保存到: D:\Workspace\FI-CAD-Predictor\output/results/pycaret_logisticregression_predict.csv

===== 开始调优模型: LinearDiscriminantAnalysis =====
Processing:   0%|          | 0/7 [00:00<?, ?it/s]Fitting 3 folds for each of 10 candidates, totalling 30 fits
Processing:  43%|████▎     | 3/7 [02:18<03:05, 46.32s/it]Processing:  86%|████████▌ | 6/7 [02:27<00:20, 20.81s/it]Processing: 100%|██████████| 7/7 [02:31<00:00, 17.05s/it]                                                               Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Fold                                                          
0       0.8652  0.7676  0.1285  0.4470  0.1997  0.1500  0.1854
1       0.8643  0.7318  0.1288  0.4338  0.1987  0.1477  0.1808
2       0.8711  0.7634  0.1376  0.5250  0.2180  0.1732  0.2203
Mean    0.8669  0.7543  0.1316  0.4686  0.2054  0.1569  0.1955
Std     0.0030  0.0160  0.0042  0.0402  0.0089  0.0115  0.0177
调优完成: LinearDiscriminantAnalysis
Transformation Pipeline and Model Successfully Saved
模型已保存到: D:\Workspace\FI-CAD-Predictor\output/models/pycaret/pycaret_lineardiscriminantanalysis_model
所有模型超参数已集中保存到 pycaret_model_config.yaml
LinearDiscriminantAnalysis预测结果已保存到: D:\Workspace\FI-CAD-Predictor\output/results/pycaret_lineardiscriminantanalysis_predict.csv

===== 开始调优模型: GradientBoostingClassifier =====
Processing:   0%|          | 0/7 [00:00<?, ?it/s]Fitting 3 folds for each of 10 candidates, totalling 30 fits
Processing:  43%|████▎     | 3/7 [01:48<02:25, 36.28s/it]Processing:  86%|████████▌ | 6/7 [01:57<00:16, 16.57s/it]Processing: 100%|██████████| 7/7 [02:03<00:00, 14.41s/it]                                                               Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Fold                                                          
0       0.8737  0.7583  0.0763  0.6481  0.1365  0.1120  0.1918
1       0.8685  0.7376  0.0590  0.4737  0.1049  0.0782  0.1309
2       0.8717  0.7603  0.0895 Fitting 5 folds for each of 36 candidates, totalling 180 fits
Processing:  43%|████▎     | 3/7 [09:07<12:10, 182.65s/it]Processing:  86%|████████▌ | 6/7 [09:18<01:17, 77.25s/it] Processing: 100%|██████████| 7/7 [09:20<00:00, 60.75s/it]                                                               Accuracy     AUC  Recall   Prec.      F1   Kappa     MCC
Fold                                                          
0       0.8632  0.7755  0.1200  0.4177  0.1864  0.1361  0.1682
1       0.8703  0.7334  0.1127  0.5167  0.1851  0.1451  0.1962
2       0.8660  0.7417  0.1382  0.4578  0.2123  0.1615  0.1967
3       0.8688  0.7536  0.1164  0.4923  0.1882  0.1455  0.1915
4       0.8731  0.7680  0.1600  0.5500  0.2479  0.2008  0.2473
Mean    0.8683  0.7544  0.1295  0.4869  0.2040  0.1578  0.2000
Std     0.0034  0.0157  0.0176  0.0459  0.0241  0.0230  0.0259
调优完成: LinearDiscriminantAnalysis
Transformation Pipeline and Model Successfully Saved
模型已保存到: D:\Workspace\FI-CAD-Predictor\output/models/pycaret/pycaret_lineardiscriminantanalysis_model
所有模型超参数已集中保存到 pycaret_model_config.yaml
LinearDiscriminantAnalysis预测结果已保存到: D:\Workspace\FI-CAD-Predictor\output/results/pycaret_lineardiscriminantanalysis_predict.csv

===== 开始调优模型: CatBoostClassifier =====
Processing:   0%|          | 0/7 [00:00<?, ?it/s]Fitting 5 folds for each of 50 candidates, totalling 250 fits
Processing:  43%|████▎     | 3/7 [09:37<12:50, 192.58s/it]Processing:  86%|████████▌ | 6/7 [09:49<01:21, 81.66s/it] Processing: 100%|██████████| 7/7 [09:52<00:00, 64.35s/it]                                                               Accuracy     AUC  Recall  Prec.   F1  Kappa  MCC
Fold                                                  
0          0.0  0.7658     0.0    0.0  0.0    0.0  0.0
1          0.0  0.7464     0.0    0.0  0.0    0.0  0.0
2          0.0  0.7529     0.0    0.0  0.0    0.0  0.0
3          0.0  0.7578     0.0    0.0  0.0    0.0  0.0
4          0.0  0.7714     0.0    0.0  0.0    0.0  0.0
Mean       0.0  0.7589     0.0    0.0  0.0    0.0  0.0
Std        0.0  0.0089     0.0    0.0  0.0    0.0  0.0
调优完成: CatBoostClassifier
Transformation Pipeline and Model Successfully Saved
模型已保存到: D:\Workspace\FI-CAD-Predictor\output/models/pycaret/pycaret_catboostclassifier_model
所有模型超参数已集中保存到 pycaret_model_config.yaml
Traceback (most recent call last):
  File "D:\Workspace\FI-CAD-Predictor\src\AutoML.py", line 302, in <module>
  File "D:\Workspace\FI-CAD-Predictor\src\AutoML.py", line 295, in main
  File "D:\Workspace\FI-CAD-Predictor\src\AutoML.py", line 168, in run_pycaret
  File "D:\Workspace\FI-CAD-Predictor\.venv\lib\site-packages\pycaret\classification\functional.py", line 2201, in predict_model
    return experiment.predict_model(
  File "D:\Workspace\FI-CAD-Predictor\.venv\lib\site-packages\pycaret\classification\oop.py", line 2843, in predict_model
    return super().predict_model(
  File "D:\Workspace\FI-CAD-Predictor\.venv\lib\site-packages\pycaret\internal\pycaret_experiment\supervised_experiment.py", line 5034, in predict_model
    pred = pred.astype(int)
ValueError: invalid literal for int() with base 10: 'False'
